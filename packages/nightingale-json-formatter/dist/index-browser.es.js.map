{"version":3,"file":"index-browser.es.js","sources":["../src/index.ts"],"sourcesContent":["import type { LogRecord, Metadata } from 'nightingale-types';\n\nfunction map2object(map: Map<unknown, unknown>): unknown {\n  const object: Record<string, unknown> = {};\n\n  map.forEach((value, key) => {\n    if (typeof key === 'object') {\n      // ignore key\n      return;\n    }\n\n    object[String(key)] = value;\n  });\n\n  return object;\n}\n\nfunction stringify(value: unknown, space?: string | number): string {\n  return JSON.stringify(\n    value,\n    (key, objectValue) => {\n      if (objectValue instanceof Map) {\n        return map2object(objectValue);\n      }\n      if (objectValue instanceof Error) {\n        return {\n          message: objectValue.message,\n          stack: objectValue.stack,\n        };\n      }\n\n      return objectValue as unknown;\n    },\n    space,\n  );\n}\n\nexport default function format<T extends Metadata>(\n  record: LogRecord<T>,\n): string {\n  return stringify({\n    key: record.key,\n    level: record.level,\n    datetime: record.datetime,\n    message: record.message,\n    metadata: record.metadata,\n    extra: record.extra,\n  });\n}\n"],"names":["map2object","map","object","forEach","value","key","String","stringify","space","JSON","objectValue","Map","Error","message","stack","format","record","level","datetime","metadata","extra"],"mappings":"AAEA,SAASA,UAAT,CAAoBC,GAApB,EAAyD;AACvD,MAAMC,MAA+B,GAAG,EAAxC;AAEAD,EAAAA,GAAG,CAACE,OAAJ,CAAY,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC1B,QAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC3B;AACA;AACD;;AAEDH,IAAAA,MAAM,CAACI,MAAM,CAACD,GAAD,CAAP,CAAN,GAAsBD,KAAtB;AACD,GAPD;AASA,SAAOF,MAAP;AACD;;AAED,SAASK,SAAT,CAAmBH,KAAnB,EAAmCI,KAAnC,EAAoE;AAClE,SAAOC,IAAI,CAACF,SAAL,CACLH,KADK,EAEL,UAACC,GAAD,EAAMK,WAAN,EAAsB;AACpB,QAAIA,WAAW,YAAYC,GAA3B,EAAgC;AAC9B,aAAOX,UAAU,CAACU,WAAD,CAAjB;AACD;;AACD,QAAIA,WAAW,YAAYE,KAA3B,EAAkC;AAChC,aAAO;AACLC,QAAAA,OAAO,EAAEH,WAAW,CAACG,OADhB;AAELC,QAAAA,KAAK,EAAEJ,WAAW,CAACI;AAFd,OAAP;AAID;;AAED,WAAOJ,WAAP;AACD,GAdI,EAeLF,KAfK,CAAP;AAiBD;;AAEc,SAASO,MAAT,CACbC,MADa,EAEL;AACR,SAAOT,SAAS,CAAC;AACfF,IAAAA,GAAG,EAAEW,MAAM,CAACX,GADG;AAEfY,IAAAA,KAAK,EAAED,MAAM,CAACC,KAFC;AAGfC,IAAAA,QAAQ,EAAEF,MAAM,CAACE,QAHF;AAIfL,IAAAA,OAAO,EAAEG,MAAM,CAACH,OAJD;AAKfM,IAAAA,QAAQ,EAAEH,MAAM,CAACG,QALF;AAMfC,IAAAA,KAAK,EAAEJ,MAAM,CAACI;AANC,GAAD,CAAhB;AAQD;;;;"}