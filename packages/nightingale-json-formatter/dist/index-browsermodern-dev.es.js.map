{"version":3,"file":"index-browsermodern-dev.es.js","sources":["../src/index.ts"],"sourcesContent":["import type { LogRecord, Metadata } from 'nightingale-types';\n\nfunction map2object(map: Map<unknown, unknown>): unknown {\n  const object: Record<string, unknown> = {};\n\n  map.forEach((value, key) => {\n    if (typeof key === 'object') {\n      // ignore key\n      return;\n    }\n\n    object[String(key)] = value;\n  });\n\n  return object;\n}\n\nfunction stringify(value: unknown, space?: string | number): string {\n  return JSON.stringify(\n    value,\n    (key, value) => {\n      if (value instanceof Map) {\n        return map2object(value);\n      }\n      if (value instanceof Error) {\n        return {\n          message: value.message,\n          stack: value.stack,\n        };\n      }\n\n      return value as unknown;\n    },\n    space,\n  );\n}\n\nexport default function format<T extends Metadata>(\n  record: LogRecord<T>,\n): string {\n  return stringify({\n    key: record.key,\n    level: record.level,\n    datetime: record.datetime,\n    message: record.message,\n    metadata: record.metadata,\n    extra: record.extra,\n  });\n}\n"],"names":["map2object","map","object","forEach","value","key","String","stringify","space","JSON","Map","Error","message","stack","format","record","level","datetime","metadata","extra"],"mappings":"AAEA,SAASA,UAAT,CAAoBC,GAApB,EAAyD;AACvD,QAAMC,MAA+B,GAAG,EAAxC;AAEAD,EAAAA,GAAG,CAACE,OAAJ,CAAY,CAACC,KAAD,EAAQC,GAAR,KAAgB;AAC1B,QAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC3B;AACA;AACD;;AAEDH,IAAAA,MAAM,CAACI,MAAM,CAACD,GAAD,CAAP,CAAN,GAAsBD,KAAtB;AACD,GAPD;AASA,SAAOF,MAAP;AACD;;AAED,SAASK,SAAT,CAAmBH,KAAnB,EAAmCI,KAAnC,EAAoE;AAClE,SAAOC,IAAI,CAACF,SAAL,CACLH,KADK,EAEL,CAACC,GAAD,EAAMD,KAAN,KAAgB;AACd,QAAIA,KAAK,YAAYM,GAArB,EAA0B;AACxB,aAAOV,UAAU,CAACI,KAAD,CAAjB;AACD;;AACD,QAAIA,KAAK,YAAYO,KAArB,EAA4B;AAC1B,aAAO;AACLC,QAAAA,OAAO,EAAER,KAAK,CAACQ,OADV;AAELC,QAAAA,KAAK,EAAET,KAAK,CAACS;AAFR,OAAP;AAID;;AAED,WAAOT,KAAP;AACD,GAdI,EAeLI,KAfK,CAAP;AAiBD;;AAEc,SAASM,MAAT,CACbC,MADa,EAEL;AACR,SAAOR,SAAS,CAAC;AACfF,IAAAA,GAAG,EAAEU,MAAM,CAACV,GADG;AAEfW,IAAAA,KAAK,EAAED,MAAM,CAACC,KAFC;AAGfC,IAAAA,QAAQ,EAAEF,MAAM,CAACE,QAHF;AAIfL,IAAAA,OAAO,EAAEG,MAAM,CAACH,OAJD;AAKfM,IAAAA,QAAQ,EAAEH,MAAM,CAACG,QALF;AAMfC,IAAAA,KAAK,EAAEJ,MAAM,CAACI;AANC,GAAD,CAAhB;AAQD;;;;"}