{"version":3,"file":"index-node8-dev.cjs.js","sources":["../src/index.ts"],"sourcesContent":["import { IncomingMessage } from 'http';\nimport { Record } from 'nightingale-types';\n\nexport interface ContextWithOptionalRequest {\n  request?: IncomingMessage;\n}\n\nexport default function webProcessor<T>(record: Record<T>, context?: ContextWithOptionalRequest) {\n  const request = context && context.request;\n  if (request) {\n    record.extra = record.extra || {};\n    record.extra.url = request.url;\n    record.extra.method = request.method;\n    record.extra.server = request.headers.host;\n    record.extra.ip = request.headers['x-forwarded-for'] || request.connection.remoteAddress;\n  }\n}\n"],"names":["webProcessor","record","context","request","extra","url","method","server","headers","host","ip","connection","remoteAddress"],"mappings":";;;;AAOe,SAASA,YAAT,CAAyBC,MAAzB,EAA4CC,OAA5C,EAAkF;QACzFC,OAAO,GAAGD,OAAO,IAAIA,OAAO,CAACC,OAAnC;;MACIA,OAAJ,EAAa;IACXF,MAAM,CAACG,KAAP,GAAeH,MAAM,CAACG,KAAP,IAAgB,EAA/B;IACAH,MAAM,CAACG,KAAP,CAAaC,GAAb,GAAmBF,OAAO,CAACE,GAA3B;IACAJ,MAAM,CAACG,KAAP,CAAaE,MAAb,GAAsBH,OAAO,CAACG,MAA9B;IACAL,MAAM,CAACG,KAAP,CAAaG,MAAb,GAAsBJ,OAAO,CAACK,OAAR,CAAgBC,IAAtC;IACAR,MAAM,CAACG,KAAP,CAAaM,EAAb,GAAkBP,OAAO,CAACK,OAAR,CAAgB,iBAAhB,KAAsCL,OAAO,CAACQ,UAAR,CAAmBC,aAA3E;;;;;;"}