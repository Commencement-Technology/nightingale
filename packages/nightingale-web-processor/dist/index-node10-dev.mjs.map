{"version":3,"file":"index-node10-dev.mjs","sources":["../src/index.ts"],"sourcesContent":["import type { IncomingMessage } from 'http';\nimport type { LogRecord, Metadata } from 'nightingale-types';\n\nexport interface ContextWithOptionalRequest {\n  request?: IncomingMessage;\n}\n\nexport default function webProcessor<T extends Metadata>(\n  record: LogRecord<T>,\n  context?: ContextWithOptionalRequest,\n): void {\n  const request = context?.request;\n  if (request) {\n    record.extra = record.extra || {};\n    Object.assign(record.extra, {\n      url: request.url,\n      method: request.method,\n      server: request.headers.host,\n      ip:\n        request.headers['x-forwarded-for'] || request.connection.remoteAddress,\n    });\n  }\n}\n"],"names":["webProcessor","record","context","request","extra","Object","assign","url","method","server","headers","host","ip","connection","remoteAddress"],"mappings":"AAOe,SAASA,YAAT,CACbC,MADa,EAEbC,OAFa,EAGP;AACN,QAAMC,OAAO,GAAGD,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAEC,OAAzB;;AACA,MAAIA,OAAJ,EAAa;AACXF,IAAAA,MAAM,CAACG,KAAP,GAAeH,MAAM,CAACG,KAAP,IAAgB,EAA/B;AACAC,IAAAA,MAAM,CAACC,MAAP,CAAcL,MAAM,CAACG,KAArB,EAA4B;AAC1BG,MAAAA,GAAG,EAAEJ,OAAO,CAACI,GADa;AAE1BC,MAAAA,MAAM,EAAEL,OAAO,CAACK,MAFU;AAG1BC,MAAAA,MAAM,EAAEN,OAAO,CAACO,OAAR,CAAgBC,IAHE;AAI1BC,MAAAA,EAAE,EACAT,OAAO,CAACO,OAAR,CAAgB,iBAAhB,KAAsCP,OAAO,CAACU,UAAR,CAAmBC;AALjC,KAA5B;AAOD;AACF;;;;"}