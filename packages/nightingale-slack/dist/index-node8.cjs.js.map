{"version":3,"file":"index-node8.cjs.js","sources":["../src/createBody.js","../src/index.js"],"sourcesContent":["/* eslint camelcase: \"off\" */\nimport markdownFormatter from 'nightingale-markdown-formatter/src';\nimport rawFormatter from 'nightingale-raw-formatter/src';\nimport levels from 'nightingale-levels';\n\nconst levelToSlackColor = {\n  [levels.TRACE]: '#808080',\n  [levels.DEBUG]: '#808080',\n  [levels.INFO]: '#808080',\n  [levels.WARN]: 'warning',\n  [levels.ERROR]: 'danger',\n  [levels.CRITICAL]: 'danger',\n  [levels.FATAL]: 'danger',\n  [levels.EMERGENCY]: 'danger',\n};\n\nexport default (record, slackConfig) => {\n  const markdown = markdownFormatter(record);\n  const raw = rawFormatter(record);\n\n  return {\n    channel: slackConfig.channel,\n    username: slackConfig.username,\n    icon_url: slackConfig.iconUrl,\n    icon_emoji: slackConfig.iconEmoji,\n    attachments: [\n      {\n        fallback: raw,\n        title: record.message,\n        color: levelToSlackColor[record.level],\n        text: markdown,\n        mrkdwn_in: ['text'],\n      },\n    ],\n  };\n};\n","import { post } from 'request';\nimport createBody from './createBody';\n\nconst createHandler = slackConfig => record => {\n  const body = createBody(record, slackConfig);\n\n  post({ url: slackConfig.webhookUrl, body, json: true }).on('error', err2 =>\n    console.error(err2.stack),\n  );\n};\n\ntype SlackConfigType = {|\n  webhookUrl: string,\n  channel?: ?string,\n  username?: ?string,\n  iconUrl?: ?string,\n  iconEmoji?: ?string,\n|};\n\nexport default function SlackHandler(slackConfig: SlackConfigType, minLevel: number) {\n  this.minLevel = minLevel;\n  this.handle = createHandler(slackConfig);\n}\n"],"names":["levelToSlackColor","levels","TRACE","DEBUG","INFO","WARN","ERROR","CRITICAL","FATAL","EMERGENCY","record","slackConfig","markdown","markdownFormatter","raw","rawFormatter","channel","username","iconUrl","iconEmoji","message","level","createHandler","body","createBody","url","webhookUrl","json","on","err2","console","error","stack","SlackHandler","minLevel","handle"],"mappings":";;;;;;;;;AAAA;AACA;AAIA,MAAMA,oBAAoB;GACvBC,OAAOC,KAAR,GAAgB,SADQ;GAEvBD,OAAOE,KAAR,GAAgB,SAFQ;GAGvBF,OAAOG,IAAR,GAAe,SAHS;GAIvBH,OAAOI,IAAR,GAAe,SAJS;GAKvBJ,OAAOK,KAAR,GAAgB,QALQ;GAMvBL,OAAOM,QAAR,GAAmB,QANK;GAOvBN,OAAOO,KAAR,GAAgB,QAPQ;GAQvBP,OAAOQ,SAAR,GAAoB;CARtB;;AAWA,kBAAe,CAACC,MAAD,EAASC,WAAT,KAAyB;QAChCC,WAAWC,kBAAkBH,MAAlB,CAAjB;QACMI,MAAMC,aAAaL,MAAb,CAAZ;;SAEO;aACIC,YAAYK,OADhB;cAEKL,YAAYM,QAFjB;cAGKN,YAAYO,OAHjB;gBAIOP,YAAYQ,SAJnB;iBAKQ,CACX;gBACYL,GADZ;aAESJ,OAAOU,OAFhB;aAGSpB,kBAAkBU,OAAOW,KAAzB,CAHT;YAIQT,QAJR;;KADW;GALf;CAJF;;ACbA,MAAMU,gBAAgBX,eAAeD,UAAU;QACvCa,OAAOC,WAAWd,MAAX,EAAmBC,WAAnB,CAAb;;eAEK,EAAEc,KAAKd,YAAYe,UAAnB,EAA+BH,IAA/B,EAAqCI,MAAM,IAA3C,EAAL,EAAwDC,EAAxD,CAA2D,OAA3D,EAAoEC,QAClEC,QAAQC,KAAR,CAAcF,KAAKG,KAAnB,CADF;CAHF;;AAgBA,AAAe,SAASC,YAAT,CAAsBtB,WAAtB,EAAoDuB,QAApD,EAAsE;OAC9EA,QAAL,GAAgBA,QAAhB;OACKC,MAAL,GAAcb,cAAcX,WAAd,CAAd;;;;;"}