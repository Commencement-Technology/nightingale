{"version":3,"file":"index-browsermodern-dev.es.js","sources":["../src/index.js"],"sourcesContent":["import levels from 'nightingale-levels';\n\nconst specialRegexpChars = /[\\\\^$+?.()|[\\]{}]/;\n\ntype DebugValueType = string | RegExp | Array<string | RegExp>;\n\nconst createTestFunctionFromRegexpString = value => {\n  if (!value.endsWith('/')) throw new Error('Invalid RegExp DEBUG value');\n  const regexp = new RegExp(value.slice(1, -1));\n  return string => regexp.test(string);\n};\n\nconst createTestFunctionFromValue = value => {\n  if (value.endsWith(':*')) {\n    value = value.slice(0, -2);\n    return string => string.startsWith(value);\n  }\n\n  return string => string === value;\n};\n\nexport default function createFindDebugLevel(debugValue: ?DebugValueType) {\n  debugValue = debugValue || '';\n\n  let wilcard = false;\n  const debugValues = [];\n  const skips = [];\n\n  if (!Array.isArray(debugValue)) {\n    debugValue = debugValue.trim();\n\n    if (debugValue.startsWith('/')) {\n      debugValues.push(createTestFunctionFromRegexpString(debugValue));\n      debugValue = null;\n    } else {\n      debugValue = debugValue.split(/[\\s,]+/);\n    }\n  }\n\n  if (debugValue) {\n    debugValue.forEach(value => {\n      if (specialRegexpChars.test(value)) {\n        throw new Error(`Invalid debug value: \"${value}\" (contains special chars)`);\n      }\n\n      if (!value) return;\n\n      if (value === '*') {\n        wilcard = true;\n        return;\n      }\n\n      if (value.startsWith('-')) {\n        skips.push(createTestFunctionFromValue(value.substr(1)));\n      } else if (!wilcard) {\n        debugValues.push(createTestFunctionFromValue(value));\n      }\n    });\n  }\n\n  if (wilcard) {\n    if (skips.length === 0) {\n      return minLevel => levels.ALL;\n    } else {\n      return (minLevel, key) => (skips.some(skip => skip(key)) ? minLevel : levels.ALL);\n    }\n  }\n\n  if (debugValues.length === 0) {\n    return (minLevel: number) => minLevel;\n  }\n\n  return (minLevel, key) => {\n    if (minLevel === levels.ALL || !key) {\n      return minLevel;\n    }\n\n    if (debugValues.some(debugValue => debugValue(key))) {\n      return skips.some(skip => skip(key)) ? minLevel : levels.ALL;\n    }\n\n    return minLevel;\n  };\n}\n"],"names":["specialRegexpChars","createTestFunctionFromRegexpString","value","endsWith","Error","regexp","RegExp","slice","test","string","createTestFunctionFromValue","startsWith","createFindDebugLevel","debugValue","wilcard","debugValues","skips","Array","isArray","trim","push","split","forEach","substr","length","levels","ALL","minLevel","key","some","skip"],"mappings":";;;AAEA,MAAMA,qBAAqB,mBAA3B;;AAEA,gDAAsB,oBAAS,eAAT,EAAkB,QAAM,oBAAS,eAAT,CAAN,CAAlB,CAAtB;;;AAEA,MAAMC,qCAAqC,SAArCA,kCAAqC,QAAS;MAC9C,CAACC,MAAMC,QAAN,CAAe,GAAf,CAAL,EAA0B,MAAM,IAAIC,KAAJ,CAAU,4BAAV,CAAN;QACpBC,SAAS,IAAIC,MAAJ,CAAWJ,MAAMK,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,CAAX,CAAf;SACO;WAAUF,OAAOG,IAAP,CAAYC,MAAZ,CAAV;GAAP;CAHF;;AAMA,MAAMC,8BAA8B,SAA9BA,2BAA8B,QAAS;MACvCR,MAAMC,QAAN,CAAe,IAAf,CAAJ,EAA0B;YAChBD,MAAMK,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,CAAR;WACO;aAAUE,OAAOE,UAAP,CAAkBT,KAAlB,CAAV;KAAP;;;SAGK;WAAUO,WAAWP,KAArB;GAAP;CANF;;AASA,AAAe,SAASU,oBAAT,CAA8BC,UAA9B,EAA2D;wBAAnB,WAAG,cAAH,CAAmB;;;;sCAC3DA,cAAc,EAA3B;;MAEIC,UAAU,KAAd;QACMC,gBAAN;QACMC,UAAN;;MAEI,CAACC,MAAMC,OAAN,CAAcL,UAAd,CAAL,EAAgC;wCACjBA,WAAWM,IAAX,EAAb;;QAEIN,WAAWF,UAAX,CAAsB,GAAtB,CAAJ,EAAgC;kBAClBS,IAAZ,CAAiBnB,mCAAmCY,UAAnC,CAAjB;0CACa,IAAb;KAFF,MAGO;0CACQA,WAAWQ,KAAX,CAAiB,QAAjB,CAAb;;;;MAIAR,UAAJ,EAAgB;eACHS,OAAX,CAAmB,iBAAS;UACtBtB,mBAAmBQ,IAAnB,CAAwBN,KAAxB,CAAJ,EAAoC;cAC5B,IAAIE,KAAJ,CAAW,yBAAwBF,KAAM,4BAAzC,CAAN;;;UAGE,CAACA,KAAL,EAAY;;UAERA,UAAU,GAAd,EAAmB;kBACP,IAAV;;;;UAIEA,MAAMS,UAAN,CAAiB,GAAjB,CAAJ,EAA2B;cACnBS,IAAN,CAAWV,4BAA4BR,MAAMqB,MAAN,CAAa,CAAb,CAA5B,CAAX;OADF,MAEO,IAAI,CAACT,OAAL,EAAc;oBACPM,IAAZ,CAAiBV,4BAA4BR,KAA5B,CAAjB;;KAfJ;;;MAoBEY,OAAJ,EAAa;QACPE,MAAMQ,MAAN,KAAiB,CAArB,EAAwB;aACf;eAAYC,OAAOC,GAAnB;OAAP;KADF,MAEO;aACE,UAACC,QAAD,EAAWC,GAAX;eAAoBZ,MAAMa,IAAN,CAAW;iBAAQC,KAAKF,GAAL,CAAR;SAAX,IAAgCD,QAAhC,GAA2CF,OAAOC,GAAtE;OAAP;;;;MAIAX,YAAYS,MAAZ,KAAuB,CAA3B,EAA8B;WACrB,UAACG,QAAD;0BAAS,UAAT;;;aAAsBA,QAAtB;KAAP;;;SAGK,UAACA,QAAD,EAAWC,GAAX,EAAmB;QACpBD,aAAaF,OAAOC,GAApB,IAA2B,CAACE,GAAhC,EAAqC;aAC5BD,QAAP;;;QAGEZ,YAAYc,IAAZ,CAAiB;aAAchB,WAAWe,GAAX,CAAd;KAAjB,CAAJ,EAAqD;aAC5CZ,MAAMa,IAAN,CAAW;eAAQC,KAAKF,GAAL,CAAR;OAAX,IAAgCD,QAAhC,GAA2CF,OAAOC,GAAzD;;;WAGKC,QAAP;GATF;;;;;"}