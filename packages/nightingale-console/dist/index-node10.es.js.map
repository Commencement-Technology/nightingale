{"version":3,"file":"index-node10.es.js","sources":["../src/index.ts"],"sourcesContent":["import { POB_TARGET } from 'pob-babel';\nimport formatterANSI from 'nightingale-ansi-formatter';\nimport formatterJSON from 'nightingale-json-formatter';\nimport consoleOutput from 'nightingale-console-output';\nimport createFindDebugLevel from 'nightingale-debug';\nimport { IsHandling, Handle, LogRecord, Level } from 'nightingale-types';\n\nconst defaultFormatter =\n  POB_TARGET === 'node' && !process.stdout.isTTY\n    ? formatterJSON\n    : formatterANSI;\n\nconst createHandle = (\n  formatter = defaultFormatter,\n  output = consoleOutput,\n): Handle => {\n  return <T>(record: LogRecord<T>): void => {\n    return output(formatter(record), record);\n  };\n};\nconst findDebugLevel = createFindDebugLevel(process.env.DEBUG);\n\ninterface ConsoleHandlerOptions {\n  formatter?: <T>(record: LogRecord<T>) => string;\n  output?: <T>(param: string | string[], record: LogRecord<T>) => void;\n}\n\nexport default class ConsoleHandler {\n  minLevel: Level = Level.ALL;\n\n  isHandling: IsHandling;\n\n  handle: Handle;\n\n  constructor(minLevel: Level, options: ConsoleHandlerOptions = {}) {\n    this.minLevel = minLevel;\n    this.isHandling = (level: Level, key: string) =>\n      level >= findDebugLevel(minLevel, key);\n    this.handle = createHandle(options.formatter, options.output);\n  }\n}\n"],"names":["defaultFormatter","process","stdout","isTTY","formatterJSON","formatterANSI","createHandle","formatter","output","consoleOutput","record","findDebugLevel","createFindDebugLevel","env","DEBUG","ConsoleHandler","constructor","minLevel","options","Level","ALL","isHandling","level","key","handle"],"mappings":";;;;;;AAOA,MAAMA,gBAAgB,GACK,CAACC,OAAO,CAACC,MAAR,CAAeC,KAAzC,GACIC,aADJ,GAEIC,aAHN;;AAKA,MAAMC,YAAY,GAAG,CACnBC,SAAS,GAAGP,gBADO,EAEnBQ,MAAM,GAAGC,aAFU,KAGR;SACAC,MAAJ,IAAmC;WACjCF,MAAM,CAACD,SAAS,CAACG,MAAD,CAAV,EAAoBA,MAApB,CAAb;GADF;CAJF;;AAQA,MAAMC,cAAc,GAAGC,oBAAoB,CAACX,OAAO,CAACY,GAAR,CAAYC,KAAb,CAA3C;AAOA,AAAe,MAAMC,cAAN,CAAqB;EAOlCC,WAAW,CAACC,QAAD,EAAkBC,OAA8B,GAAG,EAAnD,EAAuD;SANlED,QAMkE,GANhDE,KAAK,CAACC,GAM0C;SAC3DH,QAAL,GAAgBA,QAAhB;;SACKI,UAAL,GAAkB,CAACC,KAAD,EAAeC,GAAf,KAChBD,KAAK,IAAIX,cAAc,CAACM,QAAD,EAAWM,GAAX,CADzB;;SAEKC,MAAL,GAAclB,YAAY,CAACY,OAAO,CAACX,SAAT,EAAoBW,OAAO,CAACV,MAA5B,CAA1B;;;;;;;"}